âœ” Requires:

A Meta Developer Account

A WhatsApp Cloud API setup (free)

A Webhook URL (can use ngrok for testing)

Your Permanent Access Token

Your Phone Number ID

Your WhatsApp Business Account ID



from flask import Flask, request, jsonify
import requests

app = Flask(__name__)

VERIFY_TOKEN = "my_verify_token"   # Your verification token
ACCESS_TOKEN = "YOUR_WHATSAPP_ACCESS_TOKEN"  # Permanent token
PHONE_NUMBER_ID = "YOUR_PHONE_NUMBER_ID"


def send_whatsapp_message(to, message):
    url = f"https://graph.facebook.com/v18.0/{PHONE_NUMBER_ID}/messages"
    headers = {
        "Authorization": f"Bearer {ACCESS_TOKEN}",
        "Content-Type": "application/json"
    }

    payload = {
        "messaging_product": "whatsapp",
        "to": to,
        "text": { "body": message }
    }

    response = requests.post(url, headers=headers, json=payload)
    return response.json()


@app.route("/webhook", methods=["GET","POST"])
def webhook():

    # -- Webhook Verification --
    if request.method == "GET":
        if request.args.get("hub.verify_token") == VERIFY_TOKEN:
            return request.args.get("hub.challenge")
        return "Invalid verification token"

    # -- Auto Reply Logic --
    data = request.get_json()

    try:
        # Extract message info
        phone = data["entry"][0]["changes"][0]["value"]["messages"][0]["from"]
        msg = data["entry"][0]["changes"][0]["value"]["messages"][0]["text"]["body"]

        # Customize your auto reply message
        reply = f"Hi! You said: {msg}\n\nThis is an automated response."

        send_whatsapp_message(phone, reply)

    except Exception as e:
        print("Error:", e)

    return jsonify({"status": "ok"})


if __name__ == "__main__":
    app.run(port=5000, debug=True)


2. Use ngrok to expose your local server

ngrok http 5000


