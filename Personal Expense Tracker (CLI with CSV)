import csv
from datetime import datetime

FILENAME = "expenses.csv"

def initialize_file():
    try:
        with open(FILENAME, mode='x', newline='') as file:
            writer = csv.writer(file)
            writer.writerow(["Date", "Type", "Category", "Amount", "Description"])
    except FileExistsError:
        pass

def add_transaction():
    date = datetime.now().strftime("%Y-%m-%d")
    trans_type = input("Enter transaction type (Income/Expense): ").capitalize()
    category = input("Enter category (e.g. Food, Salary, Travel): ")
    amount = float(input("Enter amount: "))
    description = input("Enter description (optional): ")

    with open(FILENAME, mode='a', newline='') as file:
        writer = csv.writer(file)
        writer.writerow([date, trans_type, category, amount, description])
    print("Transaction recorded.")

def view_transactions():
    with open(FILENAME, mode='r') as file:
        reader = csv.reader(file)
        for row in reader:
            print("\t".join(row))

def total_summary():
    income = 0
    expense = 0
    with open(FILENAME, mode='r') as file:
        reader = csv.DictReader(file)
        for row in reader:
            amt = float(row["Amount"])
            if row["Type"] == "Income":
                income += amt
            else:
                expense += amt
    print(f"Total Income: ₹{income}")
    print(f"Total Expense: ₹{expense}")
    print(f"Net Savings: ₹{income - expense}")

def menu():
    initialize_file()
    while True:
        print("\n--- Personal Expense Tracker ---")
        print("1. Add Transaction")
        print("2. View All Transactions")
        print("3. View Summary")
        print("4. Exit")

        choice = input("Enter your choice: ")
        if choice == "1":
            add_transaction()
        elif choice == "2":
            view_transactions()
        elif choice == "3":
            total_summary()
        elif choice == "4":
            break
        else:
            print("Invalid choice.")

if __name__ == "__main__":
    menu()
